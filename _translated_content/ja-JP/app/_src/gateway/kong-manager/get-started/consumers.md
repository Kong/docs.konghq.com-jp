---
title: "コンシューマによる認証"
---
この例では、 **Key Authenticationプラグイン** を有効にして、キー認証を使用するコンシューマを作成します。API Key Authenticationは、API認証を実行する最も一般的な方法の1つであり、必要に応じてアクセスキーを作成および削除するように実装できます。

Admin APIを使用する場合は、[{{site.base_gateway}}使用開始ガイド](/gateway/latest/get-started/key-authentication/)を参照してください。

Key Authenticationプラグインの設定
--------------------------

Kong Managerの **ワークスペース** タブ：

1. **デフォルトの** ワークスペースを開きます。

2. メニューで、 **ルート** を開き、作成した **モック** ルートを選択します。

3. サブメニューから **プラグイン（Plugins）** タブを選択し、 **プラグインのインストール（Install Plugin）** をクリックします。

4. **Key Authentication** プラグインを見つけて、 **有効にする** をクリックします。

5. モックルートのページからプラグインが選択されているため、 **プラグインをインストール：Key\-auth** ページでは、プラグインフィールドはルートに自動的にスコープされます。

   この例では、すべてのデフォルト値を使用できることを意味します。
6. **作成** クリックします。

API キーを提供せずにルートにアクセスしようとすると、リクエストは失敗し、次のメッセージが表示されます。`"No API key found in request".`

Kongがこのルートのリクエストをプロキシする前に、APIキーが必要です。この例では、Key Authenticationプラグインをインストールしたので、最初に関連付けられたキーを持つコンシューマを作成する必要があります。

コンシューマと認証情報を設定
--------------

Kong Managerの **ワークスペース** タブ：

1. **デフォルトの** ワークスペースを開きます。
2. メニューから **コンシューマ** を開き、 **新規コンシューマ** をクリックします。
3. **ユーザー名** と **カスタムID** を入力します。この例では、各フィールドに`consumer`を使用できます。
4. **作成** クリックします。
5. ［コンシューマ］ページで新しいコンシューマを開きます。
6. サブメニューで **認証情報** を開きます。
7. **New Key Auth Credential** をクリックします。
8. キーを`apikey`に設定し、 **作成** をクリックします。

新しいKey Authentication IDは、 **コンシューマ** ページの **認証情報** タブに表示されます。

Key Authenticationの検証
---------------------

Key Authenticationプラグインを検証するには、次のURLに`?apikey=apikey`を追加してブラウザからルートにアクセスします。

    http://localhost:8000/mock?apikey=apikey

次の手順
----

次に、[ターゲットを使ったアップストリームサービスのロードバランシング](/gateway/{{page.release}}/kong-manager/get-started/load-balancing/)について学びます。

